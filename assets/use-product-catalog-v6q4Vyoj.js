import{u as C,r as I}from"./ui-CvrfViwR.js";import{u as M}from"./index-C5Uq8mPh.js";const B=(u,t)=>Object.keys(t).filter(i=>i.startsWith(`${u}_`)).map(i=>{const n=t[i];return typeof n=="string"&&n.trim()!==""?Number(n):NaN}).filter(i=>!isNaN(i)),N=u=>{var n,m,a,l,c,k,_,h,f,y,p;const t=u.acf,i=s=>s?s.split(/\r?\n+/).map(g=>g.trim()).filter(Boolean):[];return{id:(n=u.title)==null?void 0:n.rendered,title:{ru:t.title.title_ru,kk:t.title.title_kk},titleMob:{ru:((m=t.title_mob)==null?void 0:m.title_mob_ru)||"",kk:((a=t.title_mob)==null?void 0:a.title_mob_kk)||""},description:{ru:((l=t.description)==null?void 0:l.description_ru)||"",kk:((c=t.description)==null?void 0:c.description_kk)||""},pageHeader:{ru:((k=t.page_header)==null?void 0:k.page_header_ru)||"",kk:((_=t.page_header)==null?void 0:_.page_header_kk)||""},text:{ru:i((h=t.text)==null?void 0:h.ru),kk:i((f=t.text)==null?void 0:f.kk)},shortName:{ru:t.short_name.short_name_ru,kk:t.short_name.short_name_kk},images:[t.image_1,t.image_2,t.image_3,t.image_4,t.image_5,t.image_6].filter(s=>typeof s=="string"),price:Number(t.price)||0,time:Number(t.time)||0,alt:t.alt||"",material:{ru:((y=t.material)==null?void 0:y.material_ru)||"",kk:((p=t.material)==null?void 0:p.material_kk)||""},set:{ru:Object.entries(t.set||{}).filter(([s,g])=>s.startsWith("set_ru_item_")&&g.trim()!=="").map(([,s])=>s.trim()),kk:Object.entries(t.set||{}).filter(([s,g])=>s.startsWith("set_kk_item_")&&g.trim()!=="").map(([,s])=>s.trim())},sizes:{width:B("width",t),height:B("height",t),depth:B("depth",t)},categoryId:t.category_id,collectionId:t.collection_id,order:Number(t.order)||1}},P=u=>{var i,n,m,a,l,c;const t=u.acf;return{id:t.id||String(u.id),title:{ru:((i=t.title)==null?void 0:i.title_ru)||"",kk:((n=t.title)==null?void 0:n.title_kk)||""},heroImage:t["hero-image"]||"",heroAlt:t["hero-alt"]||"",heroDescription:{ru:(m=t["hero-description"])!=null&&m.ru?[t["hero-description"].ru]:[],kk:(a=t["hero-description"])!=null&&a.kk?[t["hero-description"].kk]:[]},heroComment:{ru:((l=t["hero-comment"])==null?void 0:l.ru)||"",kk:((c=t["hero-comment"])==null?void 0:c.kk)||""},categoryId:t.category_id||"",order:Number(t.order)||0,items:[]}},W=()=>{const{i18n:u}=C(),t=u.language,{products:i,collections:n,isLoaded:m}=M(),a=I.useMemo(()=>i!=null&&i.length?i.map(N).sort((r,e)=>(r.order??0)-(e.order??0)):[],[i]),l=I.useMemo(()=>{if(!(n!=null&&n.length))return[];const r=n.map(P);for(const e of r)e.items=a.filter(o=>o.collectionId===e.id).sort((o,d)=>(o.order??0)-(d.order??0));return r.sort((e,o)=>(e.order??0)-(o.order??0))},[n,a]),c=I.useMemo(()=>{const r=new Map;for(const e of l)r.set(e.id,e);return r},[l]),k=I.useMemo(()=>{const r=new Map;for(const e of a)r.set(e.id,e);return r},[a]),_=r=>c.get(r),h=r=>{var e,o;return((o=(e=c.get(r))==null?void 0:e.title)==null?void 0:o[t])??""},f=(r,e)=>{var o,d;return(d=(o=c.get(r))==null?void 0:o.items)==null?void 0:d.find(b=>b.id===e)},y=r=>k.get(r),p=r=>{const e=c.get(r);if(!e)return;const o=e.categoryId,d={doors:{ru:"Двери",kk:"Есіктер"},furniture:{ru:"Мебель",kk:"Жиһаз"},facades:{ru:"Фасады",kk:"Фасадтар"},gifts:{ru:"Подарки",kk:"Сыйлықтар"}};if(!(!o||!d[o]))return{id:o,title:d[o],collections:l.filter(b=>b.categoryId===o)}};return{isLoading:!m,getCollectionById:_,getCollectionTitleById:h,getItemById:f,getProductById:y,getCategoryByCollectionId:p,getProductDetailsById:r=>{const e=k.get(r);if(!e||!e.collectionId)return null;const o=c.get(e.collectionId),d=o?p(o.id):void 0;return!o||!d?null:{product:e,collection:o,category:d}},getCollectionsByCategoryId:r=>l.filter(e=>e.categoryId===r)}};export{W as u};
